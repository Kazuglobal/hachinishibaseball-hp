# GAS Web App セットアップ手順（重要）

## 問題の原因
`e`が空のオブジェクト`{}`になっている場合、GASのデプロイ設定に問題があります。

## 正しいセットアップ手順

### 1. Google Apps Scriptでプロジェクトを作成
1. [Google Apps Script](https://script.google.com/)にアクセス
2. 「新しいプロジェクト」をクリック
3. `gas-script.js`の内容をコピー＆ペースト
4. 「保存」をクリック

### 2. スプレッドシートを作成（重要）
1. [Googleスプレッドシート](https://sheets.google.com/)にアクセス
2. 新しいスプレッドシートを作成
3. 名前を「OB会出欠フォーム回答」に変更
4. Google Apps Scriptに戻る
5. 「リソース」→「Google スプレッドシート」→「スプレッドシートを追加」
6. 作成したスプレッドシートを選択

### 3. デプロイ設定（最重要）
1. 「デプロイ」→「新しいデプロイ」をクリック
2. 「種類の選択」の横の歯車アイコンをクリック
3. 「ウェブアプリ」を選択
4. **以下の設定を必ず確認：**
   - **説明**: 「OB会出欠フォーム v1」など
   - **次のユーザーとして実行**: **「自分」**（重要！）
   - **アクセスできるユーザー**: **「全員」**（重要！）
5. 「デプロイ」をクリック
6. **初回デプロイ時は承認が必要です：**
   - 「承認が必要です」をクリック
   - Googleアカウントを選択
   - 「詳細」→「OB会出欠フォーム（安全ではないページ）に移動」をクリック
   - 「許可」をクリック
7. 表示されたWebアプリのURLをコピー
8. `src/components/support/support.component.ts`の69行目の`GAS_WEB_APP_URL`に貼り付け

### 4. 再デプロイ（コードを更新した場合）
1. 「デプロイ」→「デプロイを管理」をクリック
2. 既存のデプロイの右側の「編集」をクリック
3. 「バージョン」を「新しいバージョン」に変更
4. **設定を再確認：**
   - 「次のユーザーとして実行」: **「自分」**
   - 「アクセスできるユーザー」: **「全員」**
5. 「デプロイ」をクリック

## トラブルシューティング

### `e`が`undefined`または空のオブジェクト`{}`になる場合
1. **デプロイ設定を確認**
   - 「次のユーザーとして実行」が「自分」になっているか確認
   - 「アクセスできるユーザー」が「全員」になっているか確認
2. **再デプロイを実行**
   - 設定を変更した場合は、必ず「新しいバージョン」で再デプロイ
3. **GASスクリプトのログを確認**
   - 「実行」→「ログを表示」でエラーメッセージを確認

### スプレッドシートにデータが記録されない場合
1. GASスクリプトにスプレッドシートが紐付けられているか確認
2. 「リソース」→「Google スプレッドシート」でスプレッドシートが表示されているか確認

### メールが届かない場合
1. GASスクリプトのログでメール送信エラーがないか確認
2. `hachinishibaseball@gmail.com`のアドレスが正しいか確認
3. スパムフォルダを確認

